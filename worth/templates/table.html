<style>
/* Tighten vertical spacing for tables rendered via this template */
table.compact {
    border-collapse: collapse; /* eliminate space between cell borders */
    border-spacing: 0;         /* safety for non-collapsed layouts */
    table-layout: fixed;       /* enforce column widths; prevents expansion */
    /* Keep table width hugging content; do not stretch */
    width: auto !important;
    /* Remove outside horizontal space so the table sits flush under headings */
    margin-left: 0 !important;
    margin-right: 0 !important;
}
/* Override DataTables defaults that center tables with auto margins */
table.compact.dataTable,
table.dataTable.compact,
table.display.compact {
    width: auto !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
}
table.compact th,
table.compact td {
    padding: 2px 6px;          /* reduce space above/below each line */
    line-height: 1.1;          /* compact line height */
    white-space: nowrap;       /* keep columns narrow by avoiding wraps */
    overflow: hidden;          /* prevent content from expanding cells */
    text-overflow: ellipsis;   /* show ellipsis for overflowed content */
}
table.compact thead th {
    padding-top: 4px;
    padding-bottom: 4px;
}

/* Optional: apply to specific cells/columns to cap width with ellipsis */
table.compact th.truncate,
table.compact td.truncate {
    max-width: 140px;
    overflow: hidden;
    text-overflow: ellipsis;
}
</style>

<table id="{{ table_id }}" class="display border compact">
    <thead>
        <tr>
            {% for h in headings %}
                <th>{{ h }}</th>
            {% endfor %}
        </tr>
    </thead>
    <tbody>

    {% for rec in data %}
        <tr>
            {% for x in rec %}
                <td>{{ x|safe }}</td>
            {% endfor %}
        </tr>
    {% endfor %}
    </tbody>
</table>

{#<script>#}
{#FORMATS = eval({{ formats | safe }})#}
{#console.log(FORMATS)#}
{#$.extend( true, $.fn.dataTable.defaults, FORMATS)#}
{##}
{#$(document).ready(function () {#}
{#    $('#{{ table_id }}').DataTable();#}
{#});#}
{#</script>#}

<script type="text/javascript" defer="defer">
$(document).ready(function() {
    var __userOpts = undefined;
    try { __userOpts = eval({{ formats | safe }}); } catch(e) { __userOpts = {}; }
    var __opts = $.extend({ autoWidth: false }, __userOpts || {});
    $("table[id={{ table_id }}]").DataTable(__opts);
});
</script>
